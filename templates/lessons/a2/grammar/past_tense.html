{% extends "layout.html" %}

{% block title %}A2 - Past Tense (Perfekt) | DeutschLernHub{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('a2_index') }}">A2</a></li>
                    <li class="breadcrumb-item active">Past Tense (Perfekt)</li>
                </ol>
            </nav>

            <div class="lesson-container">
                <div class="lesson-header card shadow-sm mb-4">
                    <div class="card-body">
                        <h1 class="lesson-title text-center">Past Tense (Perfekt)</h1>
                        <p class="lead text-center">Learn how to talk about past events in German</p>
                        
                        {% if current_user.is_authenticated %}
                        <div class="progress mb-3">
                            <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <div class="lesson-content card shadow-sm mb-4">
                    <div class="card-body">
                        <section id="introduction">
                            <h2>Introduction to Perfekt</h2>
                            <p>The <strong>Perfekt</strong> tense is one of the most common ways to talk about the past in German, especially in spoken language. Unlike English, which has a simple past tense ("I walked"), German relies heavily on the Perfekt tense for everyday conversations about past events.</p>
                            <p>The Perfekt tense is formed with a helping verb (<em>haben</em> or <em>sein</em>) and the <em>Partizip II</em> (past participle) of the main verb.</p>
                            
                            <div class="alert alert-info">
                                <h5>Basic Structure:</h5>
                                <p><strong>Subject + auxiliary verb (haben/sein) + objects/adverbs + past participle</strong></p>
                                <ul>
                                    <li><em>Ich <strong>habe</strong> gestern einen Film <strong>gesehen</strong>.</em> (I watched a movie yesterday.)</li>
                                    <li><em>Er <strong>ist</strong> nach Berlin <strong>gefahren</strong>.</em> (He went to Berlin.)</li>
                                </ul>
                            </div>
                        </section>

                        <section id="auxiliary-verbs">
                            <h2>Auxiliary Verbs: Haben and Sein</h2>
                            <p>Choosing the correct auxiliary verb (<em>haben</em> or <em>sein</em>) is a crucial part of forming the Perfekt tense.</p>
                            
                            <h3>When to use <em>haben</em>:</h3>
                            <ul>
                                <li>Transitive verbs (verbs that take a direct object)
                                    <ul>
                                        <li><em>Ich <strong>habe</strong> das Buch <strong>gelesen</strong>.</em> (I read the book.)</li>
                                        <li><em>Er <strong>hat</strong> seine Hausaufgaben <strong>gemacht</strong>.</em> (He did his homework.)</li>
                                    </ul>
                                </li>
                                <li>Most intransitive verbs (verbs that don't take a direct object)
                                    <ul>
                                        <li><em>Wir <strong>haben</strong> lange <strong>geschlafen</strong>.</em> (We slept for a long time.)</li>
                                        <li><em>Sie <strong>hat</strong> viel <strong>gearbeitet</strong>.</em> (She worked a lot.)</li>
                                    </ul>
                                </li>
                                <li>Reflexive verbs
                                    <ul>
                                        <li><em>Ich <strong>habe</strong> mich <strong>gewaschen</strong>.</em> (I washed myself.)</li>
                                    </ul>
                                </li>
                            </ul>
                            
                            <h3>When to use <em>sein</em>:</h3>
                            <ul>
                                <li>Verbs of motion that indicate a change in position or location
                                    <ul>
                                        <li><em>Ich <strong>bin</strong> nach Hause <strong>gegangen</strong>.</em> (I went home.)</li>
                                        <li><em>Er <strong>ist</strong> in die Stadt <strong>gefahren</strong>.</em> (He drove to the city.)</li>
                                        <li><em>Sie <strong>sind</strong> ins Kino <strong>gelaufen</strong>.</em> (They walked to the cinema.)</li>
                                    </ul>
                                </li>
                                <li>Verbs that indicate a change of state
                                    <ul>
                                        <li><em>Das Wetter <strong>ist</strong> besser <strong>geworden</strong>.</em> (The weather got better.)</li>
                                        <li><em>Die Blume <strong>ist</strong> <strong>gewachsen</strong>.</em> (The flower grew.)</li>
                                        <li><em>Er <strong>ist</strong> früh <strong>aufgestanden</strong>.</em> (He got up early.)</li>
                                    </ul>
                                </li>
                                <li>Specific verbs that always use <em>sein</em>, including:
                                    <ul>
                                        <li><em>sein</em> (to be): <em>Ich <strong>bin</strong> dort <strong>gewesen</strong>.</em> (I was there.)</li>
                                        <li><em>bleiben</em> (to stay): <em>Er <strong>ist</strong> zu Hause <strong>geblieben</strong>.</em> (He stayed at home.)</li>
                                        <li><em>passieren</em> (to happen): <em>Was <strong>ist</strong> <strong>passiert</strong>?</em> (What happened?)</li>
                                    </ul>
                                </li>
                            </ul>
                            
                            <div class="alert alert-warning">
                                <h5>Important Tip:</h5>
                                <p>The following motion verbs use <em>sein</em>: <em>gehen, kommen, fahren, fliegen, laufen, reisen, schwimmen</em> (when indicating direction), etc.</p>
                            </div>
                        </section>
                        
                        <section id="past-participle">
                            <h2>Forming the Past Participle (Partizip II)</h2>
                            <p>The past participle in German has different formation rules depending on whether the verb is regular or irregular.</p>
                            
                            <h3>Regular Verbs:</h3>
                            <p>For regular verbs, the past participle is formed with:</p>
                            <div class="formula-box">
                                <p><strong>ge- + verb stem + -t</strong></p>
                            </div>
                            <ul>
                                <li><em>machen</em> (to do/make): <strong>ge-mach-t</strong></li>
                                <li><em>spielen</em> (to play): <strong>ge-spiel-t</strong></li>
                                <li><em>kaufen</em> (to buy): <strong>ge-kauf-t</strong></li>
                                <li><em>hören</em> (to hear/listen): <strong>ge-hör-t</strong></li>
                            </ul>
                            
                            <h3>Irregular Verbs:</h3>
                            <p>For irregular verbs, the past participle is formed with:</p>
                            <div class="formula-box">
                                <p><strong>ge- + changed verb stem + -en</strong></p>
                            </div>
                            <p>The change in the verb stem often involves a vowel change.</p>
                            <ul>
                                <li><em>schreiben</em> (to write): <strong>ge-schrieb-en</strong></li>
                                <li><em>lesen</em> (to read): <strong>ge-les-en</strong></li>
                                <li><em>trinken</em> (to drink): <strong>ge-trunk-en</strong></li>
                                <li><em>singen</em> (to sing): <strong>ge-sung-en</strong></li>
                            </ul>
                            
                            <h3>Verbs with separable prefixes:</h3>
                            <p>For verbs with separable prefixes, the <em>ge-</em> is inserted between the prefix and the verb stem:</p>
                            <ul>
                                <li><em>aufstehen</em> (to get up): <strong>auf-ge-standen</strong></li>
                                <li><em>einkaufen</em> (to shop): <strong>ein-ge-kauft</strong></li>
                                <li><em>ankommen</em> (to arrive): <strong>an-ge-kommen</strong></li>
                                <li><em>mitbringen</em> (to bring along): <strong>mit-ge-bracht</strong></li>
                            </ul>
                            
                            <h3>Verbs with inseparable prefixes:</h3>
                            <p>Verbs with inseparable prefixes (be-, ge-, er-, ver-, zer-, ent-, emp-, miss-) do not add <em>ge-</em> in the past participle:</p>
                            <ul>
                                <li><em>bezahlen</em> (to pay): <strong>bezahlt</strong> (not <del>gebezahlt</del>)</li>
                                <li><em>verstehen</em> (to understand): <strong>verstanden</strong> (not <del>geverstanden</del>)</li>
                                <li><em>erzählen</em> (to tell): <strong>erzählt</strong> (not <del>geerzählt</del>)</li>
                                <li><em>entdecken</em> (to discover): <strong>entdeckt</strong> (not <del>geentdeckt</del>)</li>
                            </ul>
                            
                            <h3>Verbs ending in -ieren:</h3>
                            <p>Verbs ending in <em>-ieren</em> do not take <em>ge-</em> in the past participle:</p>
                            <ul>
                                <li><em>studieren</em> (to study): <strong>studiert</strong> (not <del>gestudiert</del>)</li>
                                <li><em>telefonieren</em> (to telephone): <strong>telefoniert</strong> (not <del>getelefoniert</del>)</li>
                                <li><em>funktionieren</em> (to function): <strong>funktioniert</strong> (not <del>gefunktioniert</del>)</li>
                            </ul>
                            
                            <div class="alert alert-info">
                                <h5>Memory Aid:</h5>
                                <p>Remember that most German verbs use <em>haben</em> in the Perfekt. Only use <em>sein</em> for:</p>
                                <ol>
                                    <li>Motion verbs (when there's a change in location)</li>
                                    <li>Verbs showing a change of state</li>
                                    <li>The specific verbs <em>sein, bleiben, passieren</em>, etc.</li>
                                </ol>
                            </div>
                        </section>
                        
                        <section id="word-order">
                            <h2>Word Order in Perfekt Sentences</h2>
                            <p>In a main clause (independent sentence), the conjugated auxiliary verb (<em>haben</em> or <em>sein</em>) comes in the second position, and the past participle goes to the end of the sentence.</p>
                            
                            <div class="row mb-4">
                                <div class="col">
                                    <div class="card">
                                        <div class="card-header">Basic Word Order</div>
                                        <div class="card-body">
                                            <p><strong>Position 1</strong> | <strong>Position 2 (Auxiliary)</strong> | <strong>Middle Field (Objects, Adverbs)</strong> | <strong>End (Past Participle)</strong></p>
                                            <p>Ich | <strong>habe</strong> | gestern einen Film | <strong>gesehen</strong>.</p>
                                            <p>Wir | <strong>sind</strong> | letzte Woche nach Berlin | <strong>gefahren</strong>.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <h3>More Examples:</h3>
                            <ul>
                                <li><em>Ich <strong>habe</strong> gestern viel <strong>gearbeitet</strong>.</em> (I worked a lot yesterday.)</li>
                                <li><em>Er <strong>hat</strong> ein interessantes Buch <strong>gelesen</strong>.</em> (He read an interesting book.)</li>
                                <li><em>Wir <strong>haben</strong> am Wochenende Freunde <strong>besucht</strong>.</em> (We visited friends on the weekend.)</li>
                                <li><em>Sie <strong>ist</strong> früh <strong>aufgestanden</strong>.</em> (She got up early.)</li>
                                <li><em>Die Kinder <strong>sind</strong> in den Park <strong>gegangen</strong>.</em> (The children went to the park.)</li>
                            </ul>
                            
                            <h3>Questions in Perfekt:</h3>
                            <p>For yes/no questions, the auxiliary verb comes first:</p>
                            <ul>
                                <li><em><strong>Hast</strong> du den Film <strong>gesehen</strong>?</em> (Did you see the movie?)</li>
                                <li><em><strong>Ist</strong> er nach Hause <strong>gegangen</strong>?</em> (Did he go home?)</li>
                            </ul>
                            
                            <p>For W-questions, the question word comes first, followed by the auxiliary verb:</p>
                            <ul>
                                <li><em>Wo <strong>hast</strong> du das Buch <strong>gekauft</strong>?</em> (Where did you buy the book?)</li>
                                <li><em>Wann <strong>ist</strong> sie <strong>angekommen</strong>?</em> (When did she arrive?)</li>
                                <li><em>Was <strong>habt</strong> ihr gestern <strong>gemacht</strong>?</em> (What did you do yesterday?)</li>
                            </ul>
                        </section>
                        
                        <section id="practice">
                            <h2>Practice Activities</h2>
                            
                            <div class="card mb-4">
                                <div class="card-header">Exercise 1: Fill in the correct auxiliary verb</div>
                                <div class="card-body">
                                    <p>Complete each sentence with <em>haben</em> or <em>sein</em> in the correct form.</p>
                                    <ol>
                                        <li>Ich ________ gestern ins Kino gegangen.</li>
                                        <li>Er ________ ein Buch gelesen.</li>
                                        <li>Wir ________ viel Spaß gehabt.</li>
                                        <li>Sie ________ in Berlin geblieben.</li>
                                        <li>Das Kind ________ schnell gewachsen.</li>
                                    </ol>
                                    <button class="btn btn-sm btn-outline-secondary mt-2" type="button" data-toggle="collapse" data-target="#answers1">Show Answers</button>
                                    <div class="collapse" id="answers1">
                                        <div class="card card-body mt-2">
                                            <ol>
                                                <li>Ich <strong>bin</strong> gestern ins Kino gegangen. (<em>gehen</em> indicates movement)</li>
                                                <li>Er <strong>hat</strong> ein Buch gelesen. (<em>lesen</em> is transitive)</li>
                                                <li>Wir <strong>haben</strong> viel Spaß gehabt. (<em>haben</em> is always with <em>haben</em>)</li>
                                                <li>Sie <strong>ist</strong> in Berlin geblieben. (<em>bleiben</em> always uses <em>sein</em>)</li>
                                                <li>Das Kind <strong>ist</strong> schnell gewachsen. (<em>wachsen</em> indicates change of state)</li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">Exercise 2: Form the Past Participle</div>
                                <div class="card-body">
                                    <p>Form the past participle (Partizip II) of these verbs:</p>
                                    <ol>
                                        <li>spielen → __________</li>
                                        <li>trinken → __________</li>
                                        <li>verstehen → __________</li>
                                        <li>aufwachen → __________</li>
                                        <li>studieren → __________</li>
                                    </ol>
                                    <button class="btn btn-sm btn-outline-secondary mt-2" type="button" data-toggle="collapse" data-target="#answers2">Show Answers</button>
                                    <div class="collapse" id="answers2">
                                        <div class="card card-body mt-2">
                                            <ol>
                                                <li>spielen → <strong>gespielt</strong> (regular verb)</li>
                                                <li>trinken → <strong>getrunken</strong> (irregular verb with vowel change)</li>
                                                <li>verstehen → <strong>verstanden</strong> (verb with inseparable prefix)</li>
                                                <li>aufwachen → <strong>aufgewacht</strong> (verb with separable prefix)</li>
                                                <li>studieren → <strong>studiert</strong> (verb ending in -ieren)</li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">Exercise 3: Form complete sentences in Perfekt</div>
                                <div class="card-body">
                                    <p>Form complete sentences in the Perfekt tense using the given elements:</p>
                                    <ol>
                                        <li>ich / einen Brief / schreiben</li>
                                        <li>er / nach Hamburg / fahren</li>
                                        <li>wir / im Restaurant / essen</li>
                                        <li>sie / früh / aufstehen</li>
                                        <li>das Kind / einschlafen</li>
                                    </ol>
                                    <button class="btn btn-sm btn-outline-secondary mt-2" type="button" data-toggle="collapse" data-target="#answers3">Show Answers</button>
                                    <div class="collapse" id="answers3">
                                        <div class="card card-body mt-2">
                                            <ol>
                                                <li>Ich <strong>habe</strong> einen Brief <strong>geschrieben</strong>.</li>
                                                <li>Er <strong>ist</strong> nach Hamburg <strong>gefahren</strong>.</li>
                                                <li>Wir <strong>haben</strong> im Restaurant <strong>gegessen</strong>.</li>
                                                <li>Sie <strong>ist</strong> früh <strong>aufgestanden</strong>.</li>
                                                <li>Das Kind <strong>ist</strong> <strong>eingeschlafen</strong>.</li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        
                        <section id="common-irregular-verbs">
                            <h2>Common Irregular Verbs in Perfekt</h2>
                            <p>Here's a table of some common irregular verbs and their past participles:</p>
                            
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <thead class="thead-light">
                                        <tr>
                                            <th>Infinitive</th>
                                            <th>Past Participle</th>
                                            <th>Auxiliary</th>
                                            <th>Example</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>sein (to be)</td>
                                            <td>gewesen</td>
                                            <td>sein</td>
                                            <td>Ich bin dort gewesen. (I was there.)</td>
                                        </tr>
                                        <tr>
                                            <td>haben (to have)</td>
                                            <td>gehabt</td>
                                            <td>haben</td>
                                            <td>Ich habe keine Zeit gehabt. (I had no time.)</td>
                                        </tr>
                                        <tr>
                                            <td>werden (to become)</td>
                                            <td>geworden</td>
                                            <td>sein</td>
                                            <td>Er ist Arzt geworden. (He became a doctor.)</td>
                                        </tr>
                                        <tr>
                                            <td>gehen (to go)</td>
                                            <td>gegangen</td>
                                            <td>sein</td>
                                            <td>Wir sind ins Kino gegangen. (We went to the cinema.)</td>
                                        </tr>
                                        <tr>
                                            <td>kommen (to come)</td>
                                            <td>gekommen</td>
                                            <td>sein</td>
                                            <td>Sie ist spät gekommen. (She came late.)</td>
                                        </tr>
                                        <tr>
                                            <td>fahren (to drive)</td>
                                            <td>gefahren</td>
                                            <td>sein</td>
                                            <td>Er ist nach Berlin gefahren. (He drove to Berlin.)</td>
                                        </tr>
                                        <tr>
                                            <td>essen (to eat)</td>
                                            <td>gegessen</td>
                                            <td>haben</td>
                                            <td>Ich habe Pizza gegessen. (I ate pizza.)</td>
                                        </tr>
                                        <tr>
                                            <td>trinken (to drink)</td>
                                            <td>getrunken</td>
                                            <td>haben</td>
                                            <td>Sie hat Wasser getrunken. (She drank water.)</td>
                                        </tr>
                                        <tr>
                                            <td>sehen (to see)</td>
                                            <td>gesehen</td>
                                            <td>haben</td>
                                            <td>Ich habe einen Film gesehen. (I saw a film.)</td>
                                        </tr>
                                        <tr>
                                            <td>lesen (to read)</td>
                                            <td>gelesen</td>
                                            <td>haben</td>
                                            <td>Er hat ein Buch gelesen. (He read a book.)</td>
                                        </tr>
                                        <tr>
                                            <td>geben (to give)</td>
                                            <td>gegeben</td>
                                            <td>haben</td>
                                            <td>Sie hat mir ein Geschenk gegeben. (She gave me a gift.)</td>
                                        </tr>
                                        <tr>
                                            <td>nehmen (to take)</td>
                                            <td>genommen</td>
                                            <td>haben</td>
                                            <td>Ich habe den Bus genommen. (I took the bus.)</td>
                                        </tr>
                                        <tr>
                                            <td>sprechen (to speak)</td>
                                            <td>gesprochen</td>
                                            <td>haben</td>
                                            <td>Wir haben Deutsch gesprochen. (We spoke German.)</td>
                                        </tr>
                                        <tr>
                                            <td>schlafen (to sleep)</td>
                                            <td>geschlafen</td>
                                            <td>haben</td>
                                            <td>Er hat lange geschlafen. (He slept for a long time.)</td>
                                        </tr>
                                        <tr>
                                            <td>finden (to find)</td>
                                            <td>gefunden</td>
                                            <td>haben</td>
                                            <td>Ich habe meinen Schlüssel gefunden. (I found my key.)</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </div>
                </div>

                <div class="lesson-quiz card shadow-sm mb-4">
                    <div class="card-body">
                        <h2>Test Your Knowledge</h2>
                        <p class="mb-3">Ready to test what you've learned? Take our Past Tense (Perfekt) quiz!</p>
                        
                        <a href="{{ url_for('quiz', level='a2', topic='past-tense') }}" class="btn btn-primary">Take the Quiz</a>
                    </div>
                </div>

                <div class="lesson-navigation card shadow-sm">
                    <div class="card-body d-flex justify-content-between">
                        <a href="{{ url_for('a2_index') }}" class="btn btn-outline-secondary">&larr; Back to A2 Overview</a>
                        <a href="{{ url_for('a2_grammar_modal_verbs') }}" class="btn btn-outline-primary">Next: Modal Verbs &rarr;</a>
                    </div>
                </div>
                
                {% if current_user.is_authenticated %}
                <div class="text-center mt-4">
                    <button id="markCompletedBtn" class="btn btn-success" data-level="A2" data-section="grammar" data-lesson="past_tense">Mark as Completed</button>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    {% if current_user.is_authenticated %}
    // Check if lesson is already completed
    $.get('/api/progress/check', {
        level: 'A2',
        section: 'grammar',
        lesson: 'past_tense'
    }).done(function(data) {
        if (data.completed) {
            $('#markCompletedBtn').text('Completed').addClass('btn-outline-success').removeClass('btn-success').prop('disabled', true);
            $('.progress-bar').css('width', '100%').attr('aria-valuenow', 100).text('100%');
        }
    });
    
    // Mark lesson as completed
    $('#markCompletedBtn').click(function() {
        const button = $(this);
        const level = button.data('level');
        const section = button.data('section');
        const lesson = button.data('lesson');
        
        $.ajax({
            url: '/api/progress/update',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({
                level: level,
                section: section,
                lesson: lesson,
                completed: true
            }),
            success: function(response) {
                button.text('Completed').addClass('btn-outline-success').removeClass('btn-success').prop('disabled', true);
                $('.progress-bar').css('width', '100%').attr('aria-valuenow', 100).text('100%');
            }
        });
    });
    {% endif %}
    
    // Enable Bootstrap tooltips
    $('[data-toggle="tooltip"]').tooltip();
    
    // Handle the collapsible sections
    $('.collapse').on('shown.bs.collapse', function() {
        $(this).prev().find('.fa-chevron-down').removeClass('fa-chevron-down').addClass('fa-chevron-up');
    });
    
    $('.collapse').on('hidden.bs.collapse', function() {
        $(this).prev().find('.fa-chevron-up').removeClass('fa-chevron-up').addClass('fa-chevron-down');
    });
});
</script>
{% endblock %}
